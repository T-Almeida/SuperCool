<!DOCTYPE html>
<html lang="en">
<head>
    <title>three.js - platformer demo</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Arima+Madurai" rel="stylesheet"> 
</head>
<body>

    <div id="container"></div>

    <div id="crosshairdiv" class="noselect">+</div>

    <div id="timespeedcontainerdiv" class="noselect progressBarBG">
        <div id="timespeeddiv" class="progressBar transpGUI"></div>
    </div>

    <div id="weaponui" class="weapon" >
        <img id="weaponicon" class="noselect transpGUI" src="icons/pistol.png"/>
        <div id="reload" class="noselect progressBarBG">
            <div id="currentreload" class="progressBar transpGUI"></div>
        </div>
        <div id="maxAmmo" class="ammo noselect transpGUI"></div>
        <div id="currentAmmo" class="ammo noselect transpGUI"></div>
    </div>

    <div id="loading">
        <div id="loadingBar"></div>
    </div>

    <div id="blocker">
        <div id="instructions">
            <span style="font-size:40px">Click to play</span>
            <br />
            (W, A, S, D = Move, SPACE = Jump, MOUSE = Look around and shoot, 1-2 = Select a gun)
        </div>
    </div>


    <!-- SCRIPTS -->
    <script src="threejs/three.js"></script>
    <script src="threejs/stats.min.js"></script>
    <script src="threejs/PointerLockControls.js"></script>
    <script src="threejs/OBJLoader.js"></script>
    <script src="threejs/MTLLoader.js"></script>
    <script src="threejs/DDSLoader.js"></script>
    <script src="threejs/TDSLoader.js"></script>
    <script src="threejs/TGALoader.js"></script>

    <script src="utils.js"></script>
    <script src="bullet.js"></script>
    <script src="weapon.js"></script>
    <script src="player.js"></script>
    <script src="enemy.js"></script>
    <script src="loader.js"></script>
    <script src="game.js"></script>
    


    <script>
        var loader, game;

        var container = document.getElementById("container");
        var blocker = document.getElementById("blocker");
        var instructions = document.getElementById( 'instructions' );

        // carregamento dos modelos 3d
        loader = new Loader();
        loader.loadModels();

        waitForLoad();

        // espera at√© todos os modelos estarem carregados
        function waitForLoad() {
            if (loader.gun1==undefined || loader.gun2==undefined || loader.gun3==undefined) {
                setTimeout(waitForLoad,200);
            } else {
                console.log("finished loading")
                startGame();
            }
        }

        function startGame() {
            document.getElementById("loading").style.display  = "none" ;
            document.getElementById("loadingBar").style.display  = "none" ;
            blocker.style.display  = "block" ;
            loadGUI();
            game = new Game();
            game.init();
            game.animate();
        }
        
        function loadGUI() {
            document.getElementById("weaponui").style.display  = "block" ;
            document.getElementById("crosshairdiv").style.display  = "block" ;
            document.getElementById("timespeedcontainerdiv").style.display  = "block" ;
        }
    </script>
</body>
</html>